<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.gci.schedule.driverless.mapper.ScheduleParamsSingleMapper">
    <resultMap id="BaseResultMap" type="com.gci.schedule.driverless.bean.scheduleD.ScheduleParamsSingle">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Mon Apr 22 13:58:59 CST 2019.
        -->
        <result column="ROUTE_ID" jdbcType="DECIMAL" property="routeId"/>
        <result column="STOP_BEGIN_TIME" jdbcType="VARCHAR" property="stopBeginTime"/>
        <result column="STOP_END_TIME" jdbcType="VARCHAR" property="stopEndTime"/>
        <result column="RUN_BEGIN_TIME" jdbcType="VARCHAR" property="runBeginTime"/>
        <result column="END_BEGIN_TIME" jdbcType="VARCHAR" property="endBeginTime"/>
        <result column="EARLIEST_BUS_NUMBER" jdbcType="DECIMAL" property="earliestBusNumber"/>
        <result column="STOP_BEGIN_TIME_DATE" jdbcType="TIMESTAMP" property="stopBeginTimeDate"/>
        <result column="STOP_END_TIME_DATE" jdbcType="TIMESTAMP" property="stopEndTimeDate"/>
        <result column="RUN_BEGIN_TIME_DATE" jdbcType="TIMESTAMP" property="runBeginTimeDate"/>
        <result column="END_BEGIN_TIME_DATE" jdbcType="TIMESTAMP" property="endBeginTimeDate"/>
        <result column="UP_BUS_COUNT" jdbcType="INTEGER" property="upBusCount"/>
        <result column="DOWN_BUS_COUNT" jdbcType="INTEGER" property="downBusCount"/>
        <result column="MINIMUM_REST_TIME" jdbcType="INTEGER" property="minimumRestTime"/>
    </resultMap>

    <resultMap id="AllResultMap" type="com.gci.schedule.driverless.bean.scheduleD.ScheduleParamsSingle">
        <result column="ROUTE_ID" jdbcType="DECIMAL" property="routeId"/>
        <result column="TEMPLATE_ID" jdbcType="INTEGER" property="templateId"/>
        <result column="STOP_BEGIN_TIME" jdbcType="VARCHAR" property="stopBeginTime"/>
        <result column="STOP_END_TIME" jdbcType="VARCHAR" property="stopEndTime"/>
        <result column="RUN_BEGIN_TIME" jdbcType="VARCHAR" property="runBeginTime"/>
        <result column="END_BEGIN_TIME" jdbcType="VARCHAR" property="endBeginTime"/>
        <result column="EARLIEST_BUS_NUMBER" jdbcType="DECIMAL" property="earliestBusNumber"/>
        <result column="STOP_BEGIN_TIME_DATE" jdbcType="TIMESTAMP" property="stopBeginTimeDate"/>
        <result column="STOP_END_TIME_DATE" jdbcType="TIMESTAMP" property="stopEndTimeDate"/>
        <result column="RUN_BEGIN_TIME_DATE" jdbcType="TIMESTAMP" property="runBeginTimeDate"/>
        <result column="END_BEGIN_TIME_DATE" jdbcType="TIMESTAMP" property="endBeginTimeDate"/>
        <result column="UP_BUS_COUNT" jdbcType="INTEGER" property="upBusCount"/>
        <result column="DOWN_BUS_COUNT" jdbcType="INTEGER" property="downBusCount"/>
        <result column="MINIMUM_REST_TIME" jdbcType="INTEGER" property="minimumRestTime"/>
    </resultMap>

    <resultMap id="shiftResultMap" type="com.gci.schedule.driverless.bean.scheduleD.ScheduleParamShift">
        <result column="ROUTE_ID" property="routeId"/>
        <result column="TEMPLATE_ID" property="templateId"/>
        <result column="SHIFT_TYPE" property="shiftType"/>
        <result column="SHIFT_NAME" property="shiftName"/>
        <result column="ORDER_NUMBER" property="orderNumber"/>
        <result column="START_TIME" property="startTime"/>
        <result column="END_TIME" property="endTime"/>
        <result column="UPDATE_USER" property="updateUser"/>
        <result column="UPDATE_TIME" property="updateTime"/>
    </resultMap>

    <select id="getByTemplateId" resultMap="BaseResultMap" parameterType="map">
    select * from BS_SCHEDULE_PARAMS_SINGLE where template_id = #{templateId, jdbcType=VARCHAR}
  </select>

    <select id="selectList" resultMap="AllResultMap" parameterType="map">
    select * from BS_SCHEDULE_PARAMS_SINGLE
  </select>

    <select id="selectByRouteId" resultMap="AllResultMap" >
        select * from BS_SCHEDULE_PARAMS_SINGLE where route_id = #{routeId,jdbcType=DECIMAL}
    </select>


    <delete id="delByTemplateId">
    delete from BS_SCHEDULE_PARAMS_SINGLE where  template_id = #{templateId, jdbcType=VARCHAR}
  </delete>
    <delete id="delShiftByTemplateId">
      delete from BS_SCHEDULE_PARAMS_SHIFT where  template_id = #{templateId, jdbcType=VARCHAR}
    </delete>

    <insert id="insert" parameterType="map">
    insert into BS_SCHEDULE_PARAMS_SINGLE (ROUTE_ID, STOP_BEGIN_TIME, STOP_END_TIME,
    RUN_BEGIN_TIME, END_BEGIN_TIME,EARLIEST_BUS_NUMBER ,UP_BUS_COUNT,DOWN_BUS_COUNT,MINIMUM_REST_TIME,TEMPLATE_ID ,UPDATE_USER,UPDATE_TIME)
    values (#{routeId,jdbcType=DECIMAL}, #{stopBeginTime,jdbcType=VARCHAR}, #{stopEndTime,jdbcType=VARCHAR},
    #{runBeginTime,jdbcType=VARCHAR}, #{endBeginTime,jdbcType=VARCHAR}, #{earliestBusNumber,jdbcType=VARCHAR},
    #{upBusCount,jdbcType=VARCHAR},#{downBusCount,jdbcType=VARCHAR},#{minimumRestTime,jdbcType=VARCHAR}
    ,#{templateId, jdbcType=VARCHAR} ,#{updateUser, jdbcType=VARCHAR} ,sysdate)
  </insert>

    <select id="getByRoute" resultMap="BaseResultMap">
    select t.*,to_date(to_char(#{runDate,jdbcType=TIMESTAMP},'yyyymmdd')||t.STOP_BEGIN_TIME,'yyyymmddhh24mi') STOP_BEGIN_TIME_DATE,
    to_date(to_char(#{runDate,jdbcType=TIMESTAMP},'yyyymmdd')||t.STOP_END_TIME,'yyyymmddhh24mi') STOP_END_TIME_DATE,
    to_date(to_char(#{runDate,jdbcType=TIMESTAMP},'yyyymmdd')||t.RUN_BEGIN_TIME,'yyyymmddhh24mi') RUN_BEGIN_TIME_DATE,
    to_date(to_char(#{runDate,jdbcType=TIMESTAMP},'yyyymmdd')||t.END_BEGIN_TIME,'yyyymmddhh24mi') END_BEGIN_TIME_DATE
    from BS_SCHEDULE_PARAMS_SINGLE T
    where t.route_id = #{routeId,jdbcType=DECIMAL}
  </select>

    <select id="getShiftByTemplateId" resultMap="shiftResultMap">
        select * from bs_schedule_params_shift where template_id=#{templateId}
    </select>

    <insert id="insertByTemplate" parameterType="java.util.Map">
    insert into   bs_schedule_params_single s2 ( s2.route_id,s2.stop_begin_time,s2.stop_end_time,s2.run_begin_time,s2.end_begin_time,s2.earliest_bus_number,s2.up_bus_count,s2.down_bus_count,s2.minimum_rest_time,s2.template_id ,s2.update_user,s2.update_time
)
    (select route_id2,t.stop_begin_time,t.stop_end_time,t.run_begin_time,t.end_begin_time,t.earliest_bus_number ,t.up_bus_count,t.down_bus_count,t.minimum_rest_time,#{templateId} ,#{updateUser} ,sysdate from
     (select #{routeId} as route_id2,s.stop_begin_time,s.stop_end_time,s.run_begin_time,s.end_begin_time,s.earliest_bus_number,s.up_bus_count,s.down_bus_count,s.minimum_rest_time
     from  bs_schedule_params_single  s
     where s.route_id =0) t)

  </insert>

    <insert id="insertObject" parameterType="com.gci.schedule.driverless.bean.scheduleD.ScheduleParamsSingle">
    insert into BS_SCHEDULE_PARAMS_SINGLE (ROUTE_ID, STOP_BEGIN_TIME, STOP_END_TIME,
    RUN_BEGIN_TIME, END_BEGIN_TIME,EARLIEST_BUS_NUMBER ,UP_BUS_COUNT,DOWN_BUS_COUNT,TEMPLATE_ID ,UPDATE_USER,UPDATE_TIME,MINIMUM_REST_TIME)
    values (#{routeId,jdbcType=DECIMAL}, #{stopBeginTime,jdbcType=VARCHAR}, #{stopEndTime,jdbcType=VARCHAR},
    #{runBeginTime,jdbcType=VARCHAR}, #{endBeginTime,jdbcType=VARCHAR}, #{earliestBusNumber,jdbcType=VARCHAR},#{upBusCount,jdbcType=INTEGER},#{downBusCount,jdbcType=INTEGER}
    ,#{templateId, jdbcType=VARCHAR} ,#{updateUser, jdbcType=VARCHAR} ,sysdate,#{minimumRestTime, jdbcType=INTEGER})
  </insert>

    <insert id="saveShift">
    insert into BS_SCHEDULE_PARAMS_SHIFT (ROUTE_ID,TEMPLATE_ID,SHIFT_TYPE,SHIFT_NAME,ORDER_NUMBER,START_TIME,END_TIME,UPDATE_USER,UPDATE_TIME)
    values (#{routeId},#{templateId},#{shiftType},#{shiftName},#{orderNumber},#{startTime},#{endTime},#{updateUser},sysdate)
  </insert>
</mapper>