<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.gci.schedule.driverless.mapper.ScheduleParamsRouteMapper">
    <resultMap id="BaseResultMap" type="com.gci.schedule.driverless.bean.scheduleD.ScheduleParamsRoute">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Mon Apr 22 13:58:59 CST 2019.
        -->
        <result column="ROUTE_ID" jdbcType="DECIMAL" property="routeId"/>
        <result column="SINGLE_RUN_MAX" jdbcType="DECIMAL" property="singleRunMax"/>
        <result column="DOUBLE_RUN_MAX" jdbcType="DECIMAL" property="doubleRunMax"/>
        <result column="EARLY_END_TIME" jdbcType="VARCHAR" property="earlyEndTime"/>
        <result column="UP_LASTEST_BEGIN_TIME" jdbcType="VARCHAR" property="upLastestBeginTime"/>
        <result column="DOWN_LASTEST_BEGIN_TIME" jdbcType="VARCHAR" property="downLastestBeginTime"/>
        <result column="UP_DIRECTION" jdbcType="VARCHAR" property="upDirection"/>
        <result column="DOWN_DIRECTION" jdbcType="VARCHAR" property="downDirection"/>
        <result column="EARLY_END_TIME_DATE" jdbcType="TIMESTAMP" property="earlyEndTimeDate"/>
        <result column="UP_LASTEST_BEGIN_TIME_DATE" jdbcType="TIMESTAMP" property="upLastestBeginTimeDate"/>
        <result column="DOWN_LASTEST_BEGIN_TIME_DATE" jdbcType="TIMESTAMP" property="downLastestBeginTimeDate"/>
        <result column="END_DIRECTION" jdbcType="DECIMAL" property="endDirection"/>
        <result column="TEMPLATE_ID" jdbcType="DECIMAL" property="templateId"/>
        <!--<result column="MAX_BUS_NUMBER" jdbcType="DECIMAL" property="maxBusNumber" />-->

        <result column="VEHICLE_CONTENT" jdbcType="DECIMAL" property="vehicleContent"/>
        <result column="UP_begin_NUM" jdbcType="DECIMAL" property="upBeginNum"/>
        <result column="DOWN_begin_NUM" jdbcType="DECIMAL" property="downBeginNum"/>
        <result column="IS_REGULAR_BUS" jdbcType="DECIMAL" property="isRegularBus" />
        <result column="IS_BACK_INSERT" jdbcType="DECIMAL" property="isBackInsert" />
        <result column="ARRIVE_STA_STOP_TIME_UP" jdbcType="DECIMAL" property="arriveStaStopTimeUp" />
        <result column="ARRIVE_STA_STOP_TIME_DOWN" jdbcType="DECIMAL" property="arriveStaStopTimeDown" />

        <result column="UP_DRIVER_TIME_START" jdbcType="DECIMAL" property="upDriverTimeStart" />
        <result column="UP_DRIVER_TIME_END" jdbcType="DECIMAL" property="upDriverTimeEnd" />
        <result column="DOWN_DRIVER_TIME_START" jdbcType="DECIMAL" property="downDriverTimeStart" />
        <result column="DOWN_DRIVER_TIME_END" jdbcType="DECIMAL" property="downDriverTimeEnd" />

        <result column="ENDURANCE_MILEAGE" jdbcType="DECIMAL" property="enduranceMileage" />

        <result column="DOUBLE_RUN_MAX_MOR" jdbcType="DECIMAL" property="doubleRunMaxMor"/>
        <result column="DOUBLE_RUN_MAX_NIG" jdbcType="DECIMAL" property="doubleRunMaxNig"/>
        <result column="HANDOVER_BEGIN_TIME" jdbcType="VARCHAR" property="handoverBeginTime"/>
        <result column="HANDOVER_END_TIME" jdbcType="VARCHAR" property="handoverEndTime"/>
    </resultMap>
    <update id="updateRegularBusByTemplateId">
        update BS_SCHEDULE_PARAMS_ROUTE set is_regular_bus=#{value},update_user=#{updateUser} where template_id=#{templateId}
    </update>

    <select id="getByTemplateId" resultMap="BaseResultMap" parameterType="map">
    select * from BS_SCHEDULE_PARAMS_ROUTE where  template_id = #{templateId, jdbcType=VARCHAR}
  </select>


    <delete id="delByTemplateId">
    delete from BS_SCHEDULE_PARAMS_ROUTE where template_id = #{templateId, jdbcType=VARCHAR}
  </delete>

    <insert id="insert" parameterType="map">
    insert into BS_SCHEDULE_PARAMS_ROUTE (ROUTE_ID, SINGLE_RUN_MAX,
    DOUBLE_RUN_MAX_MOR, DOUBLE_RUN_MAX_NIG,
    HANDOVER_BEGIN_TIME, HANDOVER_END_TIME,
    EARLY_END_TIME, UP_LASTEST_BEGIN_TIME, DOWN_LASTEST_BEGIN_TIME,
    UP_DIRECTION, DOWN_DIRECTION, VEHICLE_CONTENT,
    END_DIRECTION, UP_begin_NUM, DOWN_begin_NUM ,
    TEMPLATE_ID, UPDATE_USER, UPDATE_TIME,
    IS_REGULAR_BUS, IS_BACK_INSERT,
    ARRIVE_STA_STOP_TIME_UP, ARRIVE_STA_STOP_TIME_DOWN,
    UP_DRIVER_TIME_START, UP_DRIVER_TIME_END, DOWN_DRIVER_TIME_START,
    DOWN_DRIVER_TIME_END, ENDURANCE_MILEAGE)
    values (#{routeId,jdbcType=DECIMAL}, #{singleRunMax,jdbcType=DECIMAL},
    #{doubleRunMaxMor,jdbcType=VARCHAR}, #{doubleRunMaxNig,jdbcType=VARCHAR},
    #{handoverBeginTime,jdbcType=VARCHAR}, #{handoverEndTime,jdbcType=VARCHAR},
    #{earlyEndTime,jdbcType=VARCHAR}, #{upLastestBeginTime,jdbcType=VARCHAR}, #{downLastestBeginTime,jdbcType=VARCHAR},
    #{upDirection,jdbcType=VARCHAR}, #{downDirection,jdbcType=VARCHAR}, #{vehicleContent,jdbcType=DECIMAL},
    #{endDirection,jdbcType=DECIMAL}, #{upParkNum,jdbcType=DECIMAL}, #{downParkNum,jdbcType=DECIMAL},
    #{templateId, jdbcType=VARCHAR}, #{updateUser, jdbcType=VARCHAR},sysdate,
    #{isRegularBus,jdbcType=DECIMAL}, #{isBackInsert,jdbcType=DECIMAL},
    #{arriveStaStopTimeUp,jdbcType=DECIMAL}, #{arriveStaStopTimeDown,jdbcType=DECIMAL},
    #{upDriverTimeStart,jdbcType=DECIMAL}, #{upDriverTimeEnd,jdbcType=DECIMAL}, #{downDriverTimeStart,jdbcType=DECIMAL},
    #{downDriverTimeEnd,jdbcType=DECIMAL}, #{enduranceMileage,jdbcType=DECIMAL})
  </insert>

    <select id="getByRoute" resultMap="BaseResultMap">
    select t.*,to_date(to_char(#{runDate,jdbcType=TIMESTAMP},'yyyymmdd')||t.EARLY_END_TIME,'yyyymmddhh24mi') EARLY_END_TIME_DATE
    ,to_date(to_char(#{runDate,jdbcType=TIMESTAMP},'yyyymmdd')||t.UP_LASTEST_BEGIN_TIME,'yyyymmddhh24mi') UP_LASTEST_BEGIN_TIME_DATE
    ,to_date(to_char(#{runDate,jdbcType=TIMESTAMP},'yyyymmdd')||t.DOWN_LASTEST_BEGIN_TIME,'yyyymmddhh24mi') DOWN_LASTEST_BEGIN_TIME_DATE
    from BS_SCHEDULE_PARAMS_ROUTE T
    where t.route_id = #{routeId,jdbcType=DECIMAL}
  </select>

    <select id="selectList" resultMap="BaseResultMap">
        select * from bs_schedule_params_route
    </select>

    <select id="selectByRouteId" resultMap="BaseResultMap">
        select * from bs_schedule_params_route where route_id = #{routeId,jdbcType=DECIMAL}
    </select>

    <insert id="insertByTemplate" parameterType="java.util.Map">
    insert into   bs_schedule_params_route r2   (route_id ,single_run_max ,double_run_max ,early_end_time,UP_LASTEST_BEGIN_TIME
    ,DOWN_LASTEST_BEGIN_TIME,up_direction,down_direction,vehicle_content
    ,end_direction,up_begin_num ,down_begin_num
     ,template_id ,update_user,update_time, is_regular_bus, is_back_insert)
    (select route_id2,t.single_run_max,t.double_run_max,t.early_end_time,t.UP_LASTEST_BEGIN_TIME,t.DOWN_LASTEST_BEGIN_TIME, t.up_direction
      , t.down_direction ,t.vehicle_content
      , end_direction ,up_begin_num ,down_begin_num  ,#{templateId} ,#{updateUser} ,sysdate, 0, 0
      from
     (select #{routeId} as route_id2,r.single_run_max,r.double_run_max,r.early_end_time,r.UP_LASTEST_BEGIN_TIME, r.DOWN_LASTEST_BEGIN_TIME ,r.up_direction, r.down_direction ,r.vehicle_content
     , r.end_direction ,r.up_begin_num ,r.down_begin_num
     from  bs_schedule_params_route r
     where r.route_id =0) t)

  </insert>
</mapper>